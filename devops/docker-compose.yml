version: '3'
services:
  postgres-master:
    image: postgres-test:11.2
    container_name: postgres-master
    ports:
      - 15432:5432
    environment:
      PG_ROLE: master
      POSTGRES_PASSWORD: 123
  postgres-slave:
    image: postgres-test:11.2
    container_name: postgres-slave
    ports:
      - 25432:5432
    depends_on:
      - postgres-master
    environment:
      PG_ROLE: slave
      PG_MASTER_SERVICE_HOST: postgres-master

  redis:
    image: redis:5
    container_name: medicine-redis
    ports:
      - "56379:6379"

  medicine:
    image: medicine:1.0
    container_name: medicine
    ports:
      - "18080:8080"
    environment:
      PROFILES_ACTIVE: dev
    links:
      - postgres-master
      - postgres-slave
      - redis
